<wpfCoreWindow:MetroWindowExt
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:Convertidores="clr-namespace:WPFCore.Convertidores;assembly=WPFCore"
    xmlns:convertidoresLocal="clr-namespace:ComercialColindres.Convertidores"
    xmlns:controlsMahApps="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
    xmlns:Comportamientos="clr-namespace:WPFCore.Comportamientos;assembly=WPFCore"
    xmlns:misControles="clr-namespace:MisControlesWPF;assembly=MisControlesWPF"
    xmlns:wpfCoreWindow="clr-namespace:WPFCore.UtilidadesWindows;assembly=WPFCore"
    xmlns:comportamientos="clr-namespace:ComercialColindres.Comportamientos"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
    x:Class="ComercialColindres.Windows.BoletasWindow"
    Title="Boletas"
    Width="1024"
    Height="600"
    MostrarDialogo="{Binding DialogSettings, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
    SaveWindowPosition="True"
    ShowFlyout="{Binding SlidePanelIndice, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
    WindowStartupLocation="CenterScreen">

    <wpfCoreWindow:MetroWindowExt.Resources>
        <Convertidores:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <Convertidores:BoolToStringConverter x:Key="BoolToStringConverter" />
        <Convertidores:StateValueToColorConverter x:Key="StateValueToColorConverter" />
        <Convertidores:DateTimeToShortString x:Key="DateTimeToShortString" />
        <Convertidores:BinaryImageConverter x:Key="BinaryImageConverter" />
        <convertidoresLocal:EstadoColorConvert x:Key="EstadoColorConvert" />
    </wpfCoreWindow:MetroWindowExt.Resources>

    <wpfCoreWindow:MetroWindowExt.DataContext>
        <Binding Path="BoletasViewModel" Source="{StaticResource Locator}"/>
    </wpfCoreWindow:MetroWindowExt.DataContext>

    <wpfCoreWindow:MetroWindowExt.Flyouts>
        <controlsMahApps:FlyoutsControl>
            <controlsMahApps:Flyout x:Name="AgregarBoletaFlyout"
                Width="430"                
                Margin="100,0,0,0"
                Header="Agregar Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Orientation="Vertical">
                            <misControles:HeaderTextBlock Text="Planta Destino" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaPlantasAutoComplete}"       
                                    Buscar="{Binding ComandoBuscarPlantas}"
                                    SelectedItem="{Binding PlantaAutoCompleteSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <StackPanel  x:Name="VerticalFt" Margin="5" Grid.Row="0"
                                     Visibility="{Binding DatoBoleta.IsHorizontalImg, ConverterParameter=INVERTIR,  Converter={StaticResource BoolToVisibilityConverter}}">
                                <Grid
            						Height="156"
            						Width="90"
            						HorizontalAlignment="Center"
            						Background="LightGray">
                                    <Image
                                        RenderOptions.BitmapScalingMode="Fant"
                                       Stretch="Fill"
                                       Height="156"
            						   Width="90"
                                       VerticalAlignment="Top"
                                       Margin="0,0,0,0"
                                       HorizontalAlignment="Center"
            							Source="{Binding DatoBoleta.Imagen, Converter={StaticResource BinaryImageConverter}, Mode=TwoWay}" />
                                </Grid>

                                <Button
            						Width="80"
            						Margin="5"
            						HorizontalAlignment="Center"
            						Command="{Binding CommandSelectImage}"
            						Content="Seleccionar" />
                            </StackPanel>
                            <StackPanel  x:Name="HorizontalFt" Margin="5" Grid.Row="0"
                                     Visibility="{Binding DatoBoleta.IsHorizontalImg,  Converter={StaticResource BoolToVisibilityConverter}}">
                                <Grid
            						Height="120"
            						Width="186"
            						HorizontalAlignment="Center"
            						Background="LightGray">
                                    <Image
                                        RenderOptions.BitmapScalingMode="Fant"
                                       Stretch="Fill"
                                       Height="120"
            						   Width="186"
                                       VerticalAlignment="Top"
                                       Margin="0,0,0,0"
                                       HorizontalAlignment="Center"
            							Source="{Binding DatoBoleta.Imagen, Converter={StaticResource BinaryImageConverter}, Mode=TwoWay}" />
                                </Grid>

                                <Button
            						Width="80"
            						Margin="5"
            						HorizontalAlignment="Center"
            						Command="{Binding CommandSelectImage}"
            						Content="Seleccionar" />
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Código Boleta" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <StackPanel Visibility="{Binding DatoBoleta.IsShippingNumberRequired, Converter={StaticResource BoolToVisibilityConverter}}">
                                <misControles:HeaderTextBlock Text="Número de Envío" />
                                <misControles:InputTextBox Text="{Binding DatoBoleta.NumeroEnvio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Nombre del Proveedor" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaProveedoresAutoComplete}"
                                    Buscar="{Binding ComandoBuscarProveedores}"
                                    SelectedItem="{Binding ProveedorAutoCompleteSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Placa Cabezal" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.PlacaEquipo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <misControles:HeaderTextBlock Text="Nombre del Motorista" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.Motorista, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="50"/>
                            <misControles:HeaderTextBlock Text="Tipo Producto" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaCategoriaProductos}"
                                    Buscar="{Binding ComandoBuscarCategoriaProductos}"
                                    SelectedItem="{Binding CategoriaProductoAutoCompleteSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Precio Producto" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.PrecioProductoCompra,
                                                               Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" 
                                                       FontSize="12"
                                                       FontWeight="Bold"
                                                       Comportamientos:TextBoxMaskBehavior.MaximumValue="18"/>
                            <misControles:HeaderTextBlock Text="Peso Entrada (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.PesoEntrada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <misControles:HeaderTextBlock Text="Peso Salida (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.PesoSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <misControles:HeaderTextBlock Text="Cantidad Penalizada (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.CantidadPenalizada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <StackPanel Visibility="{Binding DatoBoleta.IsBonusEnable, Converter={StaticResource BoolToVisibilityConverter}}">
                                <CheckBox Margin="5" IsChecked="{Binding DatoBoleta.HasBonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">Tiene Bonificación?</CheckBox>
                                <misControles:HeaderTextBlock Text="Bonificación (t)" />
                                <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.Bonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}"
                                Visibility="{Binding DatoBoleta.HasBonus, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="LostFocus">
                                            <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </misControles:InputTextBox>
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Peso Neto (t)" />
                            <misControles:BodyTextBlock    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Text="{Binding DatoBoleta.PesoProducto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}" />
                            <misControles:HeaderTextBlock Text="Fecha de Salida" />
                            <DatePicker Margin="5" SelectedDate="{Binding DatoBoleta.FechaSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </ScrollViewer>
                    <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoCrear}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="EditarBoletaFlyout"
                Width="400"                
                Margin="100,0,0,0"
                Header="Editar Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Orientation="Vertical">
                            <StackPanel Margin="5" Grid.Row="0">
                                <Grid
                                    Height="156"
            						Width="90"            						
            						HorizontalAlignment="Center"
            						Background="LightGray">
                                    <Image
                                        RenderOptions.BitmapScalingMode="Fant"
                                       Stretch="Fill"
                                       Height="156"
            						   Width="90"
                                       VerticalAlignment="Top"
                                       Margin="0,0,0,0"
                                       HorizontalAlignment="Center"
            							Source="{Binding DatoBoleta.Imagen, Converter={StaticResource BinaryImageConverter}, Mode=TwoWay}" />
                                </Grid>

                                <Button
            						Width="80"
            						Margin="5"
            						HorizontalAlignment="Center"
            						Command="{Binding CommandSelectImage}"
            						Content="Seleccionar" />
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Planta Destino" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.NombrePlanta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Código Boleta" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <StackPanel Visibility="{Binding DatoBoleta.IsShippingNumberRequired, Converter={StaticResource BoolToVisibilityConverter}}">
                                <misControles:HeaderTextBlock Text="Número de Envío" />
                                <misControles:InputTextBox Text="{Binding DatoBoleta.NumeroEnvio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Nombre del Proveedor" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.NombreProveedor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <misControles:HeaderTextBlock Text="Nombre del Motorista" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.Motorista, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="50"/>
                            <misControles:HeaderTextBlock Text="Placa Cabezal" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.PlacaEquipo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <misControles:HeaderTextBlock Text="Tipo Producto" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaCategoriaProductos}"
                                    Buscar="{Binding ComandoBuscarCategoriaProductos}"
                                    SelectedItem="{Binding CategoriaProductoAutoCompleteSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Precio Producto" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.PrecioProductoCompra,
                                                               Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" 
                                                       FontSize="12"
                                                       FontWeight="Bold"
                                                       Comportamientos:TextBoxMaskBehavior.MaximumValue="18"/>
                            <misControles:HeaderTextBlock Text="Peso Entrada (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.PesoEntrada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <misControles:HeaderTextBlock Text="Peso Salida (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.PesoSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <misControles:HeaderTextBlock Text="Cantidad Penalizada (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.CantidadPenalizada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <StackPanel Visibility="{Binding DatoBoleta.IsBonusEnable, Converter={StaticResource BoolToVisibilityConverter}}">
                                <CheckBox Margin="5" IsChecked="{Binding DatoBoleta.HasBonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">Tiene Bonificación?</CheckBox>
                                <misControles:HeaderTextBlock Text="Bonificación (t)" />
                                <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.Bonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}"
                                Visibility="{Binding DatoBoleta.HasBonus, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="LostFocus">
                                            <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </misControles:InputTextBox>
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Peso Neto (t)" />
                            <misControles:BodyTextBlock    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Text="{Binding DatoBoleta.PesoProducto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}" />
                            <misControles:HeaderTextBlock Text="Fecha de Salida" />
                            <DatePicker Margin="5" SelectedDate="{Binding DatoBoleta.FechaSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </ScrollViewer>
                    <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoEditar}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="BusquedaProveedoresFlyout"
                Width="500"
                Margin="100,0,0,0"
                Header="Buscar Proveedor"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <misControles:BusquedaControl
                                Background="{DynamicResource AccentColorBrush}"
                                ComandoBuscar="{Binding ComandoBuscarProveedores}"
                                ComandoSeleccionarItem="{Binding ComandoSeleccionaProveedor}"
                                ListadoColumnas="{Binding ControlBusquedaProveedores.ListadoColumnasBusqueda}"
                                ListadoDatos="{Binding ControlBusquedaProveedores.DatosEncontrados, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                ValorBusqueda="{Binding ControlBusquedaProveedores.ValorBusqueda, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </Grid>
                    </ScrollViewer>
                    <Border Grid.RowSpan="1" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="AgregarOrdenCombustibleFlyout"
                Width="400"                
                Margin="100,0,0,0"
                Header="Orden Combustible"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Orientation="Vertical">
                            <misControles:HeaderTextBlock Text="Gasolinera" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaGasolinerasAutoComplete}"       
                                    Buscar="{Binding ComandoBuscarGasolineras}"
                                    SelectedItem="{Binding GasolineraAutoCompleteSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Código Gasolinera Crédito" />
                            <misControles:BodyTextBlock Text="{Binding DatoOrdenCombustible.CodigoCreditoCombustible, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <misControles:HeaderTextBlock Text="Código Factura" />
                            <misControles:InputTextBox Text="{Binding DatoOrdenCombustible.CodigoFactura, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <misControles:HeaderTextBlock Text="Autorizado Por" />
                            <misControles:InputTextBox Text="{Binding DatoOrdenCombustible.AutorizadoPor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="50"/>
                            <misControles:HeaderTextBlock Text="Placa Cabezal" />
                            <misControles:BodyTextBlock Text="{Binding DatoOrdenCombustible.PlacaEquipo}" />
                            <misControles:HeaderTextBlock Text="Monto Orden Combustible" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoOrdenCombustible.Monto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                            <misControles:HeaderTextBlock Text="Fecha Orden Combustible" />
                            <DatePicker Margin="5" SelectedDate="{Binding DatoOrdenCombustible.FechaCreacion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <misControles:HeaderTextBlock Text="Observaciones" />
                            <misControles:InputTextBox Height="80" Text="{Binding DatoOrdenCombustible.Observaciones, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                       MaxLength="80"/>
                        </StackPanel>
                    </ScrollViewer>
                    <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoAgregarOrdenCombustible}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="AgregarDescargaFlyout"
                Width="400"                
                Margin="100,0,0,0"
                Header="Descarga de Producto"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Orientation="Vertical">
                            <misControles:HeaderTextBlock Text="Encargado Cuadrilla" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaCuadrillasAutoComplete}"       
                                    Buscar="{Binding ComandoBuscarCuadrillasPorBoleta}"
                                    SelectedItem="{Binding CuadrillaAutoCompleteSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Planta Destino" />
                            <misControles:BodyTextBlock Text="{Binding BoletaSeleccionada.NombrePlanta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Precio Descarga" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoDescarga.PrecioDescarga, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}" />
                            <misControles:HeaderTextBlock Text="Proveedor" />
                            <misControles:BodyTextBlock Text="{Binding BoletaSeleccionada.NombreProveedor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Placa Cabezal" />
                            <misControles:BodyTextBlock Text="{Binding BoletaSeleccionada.PlacaEquipo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Tipo de Equipo" />
                            <misControles:BodyTextBlock Text="{Binding BoletaSeleccionada.DescripcionTipoEquipo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </StackPanel>
                    </ScrollViewer>
                    <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoAgregarDescarga}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="CierresBoletaFlyout"
                Width="650"
                Margin="100,0,0,0"
                Header="Pagos de Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <GroupBox Header="PAGO DE BOLETA">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width= "*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Código de Boleta" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0" 
                                                                Text="{Binding BoletaSeleccionada.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Proveedor" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1" 
                                                                Text="{Binding BoletaSeleccionada.NombreProveedor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        Text="Monto Total" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding BoletaSeleccionada.TotalAPagar,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="3"
                                        Text="Monto Justificado" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="3" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding DatoBoletaCierre.CantidadJustificada,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="1">
                        <GroupBox Header="DETALLE DE PAGO DE BOLETA">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width= "*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Forma de Pago" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"/>
                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="1"
                                        Grid.Column="0"                                        
                                        ItemsSource="{Binding ListaFormaPagos}"
                                        DisplayMemberPath="Descripcion"
                                        SelectedItem="{Binding FormaDePagoSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding DatoBoletaCierre.FormaDePago, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="Descripcion"/>
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Banco" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"/>
                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        ItemsSource="{Binding ListadoBancos}"
                                        DisplayMemberPath="Descripcion"                                        
                                        SelectedItem="{Binding BancoSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding DatoBoletaCierre.BancoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="BancoId"
                                        IsEnabled="{Binding FormaDePagoSeleccionada.RequiereBanco,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <misControles:HeaderTextBlock Grid.Column="2" Grid.ColumnSpan="2" Text="Linea Crédito" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"/>
                                    <ComboBox Margin="5"
                                              Grid.Row="1"
                                              Grid.Column="2"
                                              Grid.ColumnSpan="2"
                                              HorizontalContentAlignment="Center" 
                                              ItemsSource="{Binding LineasCredito}"
                                              SelectedItem="{Binding LineaCreditoSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValue="{Binding DatoBoletaCierre.LineaCreditoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValuePath="LineaCreditoId">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Margin="5" Grid.Column="0" Text="{Binding CodigoLineaCredito}"/>
                                                    <TextBlock Margin="5" Grid.Column="1" Text="{Binding CuentaFinanciera}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <misControles:HeaderTextBlock Grid.Column="0" Grid.Row="2" Text="Fecha Pago" TextAlignment="Center"
                                                              FontWeight="SemiBold"/>
                                    <DatePicker Margin="5" Grid.Column="0" Grid.Row="3" SelectedDate="{Binding DatoBoletaCierre.FechaPago, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="1" Grid.Row="2" Text="Documento Ref" TextAlignment="Center"
                                                              FontWeight="SemiBold"/>
                                    <misControles:InputTextBox Grid.Row="3" Grid.Column="1" 
                                                               Text="{Binding DatoBoletaCierre.NoDocumento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                               MaxLength="50"
                                                               IsEnabled="{Binding FormaDePagoSeleccionada.RequiereBanco,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <misControles:HeaderTextBlock Text="Monto"
                                                              Grid.Column="2" 
                                                              Grid.Row="2" 
                                                              Grid.ColumnSpan="2" 
                                                              TextAlignment="Center" 
                                                              FontWeight="SemiBold"/>
                                    <misControles:InputTextBox Grid.Row="3" Grid.Column="2" Grid.ColumnSpan="2"
                                                               FontSize="12"
                                                               FontWeight="Bold"
                                                               Text="{Binding DatoBoletaCierre.Monto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}"
                                                               Comportamientos:TextBoxMaskBehavior.MaximumValue="18"/>
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="2"
                                        Grid.Column="4"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding ComandoAgregarPagoBoleta}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="3"
                                        Grid.Column="4"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding CommandHoleTotalToPayment}"
                                        Imagen="{DynamicResource FullPathImagen}" />
                                </Grid>
                                <Grid Grid.Row="1">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding ListaBoletaCierresModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding BoletaCierreSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="55">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.ComandoRemoverPagoBoleta, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.ComandoEditarPagoBoleta, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource EditarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding CodigoLineaCredito}" Header="Linea Crédito" />
                                            <DataGridTextColumn Binding="{Binding FormaDePago}" Header="Forma Pago" />
                                            <DataGridTextColumn Binding="{Binding Monto, StringFormat=N2}" Header="Monto" />
                                            <DataGridTextColumn Binding="{Binding NombreBanco}" Header="Banco" />
                                            <DataGridTextColumn Binding="{Binding NoDocumento}" Header="Documento Ref" />
                                            <DataGridTextColumn Binding="{Binding FechaPago, StringFormat=d}" Header="Fecha" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="2" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoGuardarPagosBoleta}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="3" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="AbonosPrestamoFlyout"
                Width="650"
                Margin="100,0,0,0"
                Header="Abonos de Prestamos"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                        </Grid.RowDefinitions>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="0"
                                                             Text="Nombre Cliente"
                                                FontSize="14"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0"
                                                             Text="{Binding BoletaSeleccionada.NombreProveedor}"
                                                FontSize="14"
                                                FontWeight="Bold"                                           
                                                Foreground="Orange"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="1"
                                                             Text="Total Abono"
                                                FontSize="14"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1"
                                                             Text="{Binding DatoAbonoPrestamo.TotalAbono, StringFormat=N2}"
                                                             FontSize="14"
                                                             FontWeight="Bold"                                           
                                                             Foreground="Orange"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="2"
                                                             Text="Total a Pagar"
                                                FontSize="14"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2"
                                                             Text="{Binding DatoAbonoPrestamo.TotalAPagar, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}"
                                                             FontSize="14"
                                                             FontWeight="Bold"                                           
                                                             Foreground="Orange"/>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="1">
                        <GroupBox Header="Prestamos Pendientes">
                            <ListBox Grid.Row="1"
                             Margin="5"
                             ItemsSource="{Binding PendingLoans,
                                                   Mode=TwoWay,
                                                   UpdateSourceTrigger=PropertyChanged}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             SelectedItem="{Binding PendingLoanSelected,
                                                    Mode=TwoWay,
                                                    UpdateSourceTrigger=PropertyChanged}">

                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel IsItemsHost="True" Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>

                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox Margin="2">
                                                <Grid Width="25">
                                                    <Path Data="M1.6700134,23.702006L13.007996,23.702006C13.095001,23.956004 13.188019,24.210002 13.295013,24.460002 13.813019,25.683009 14.552002,26.779002 15.493011,27.721003 15.576996,27.803996 15.664001,27.883998 15.747009,27.964L1.6700134,27.964C0.74801636,27.964,0,27.215999,0,26.294001L0,25.372004C0,24.450007,0.74801636,23.702006,1.6700134,23.702006z M4.3390198,17.722003L12.864014,17.722003C12.617004,18.611003 12.493011,19.529002 12.493011,20.468005 12.493011,20.978999 12.529999,21.487002 12.604004,21.985003L4.3390198,21.985003C3.4170227,21.985003,2.6690063,21.236003,2.6690063,20.314006L2.6690063,19.392001C2.6690063,18.470004,3.4170227,17.722003,4.3390198,17.722003z M22.179993,14.468004L22.179993,15.517C21.338013,15.636003 20.722015,15.961 20.330017,16.492 19.938019,17.024005 19.740997,17.624003 19.740997,18.288005 19.740997,18.794001 19.851013,19.240001 20.072021,19.623004 20.290009,20.004001 20.575012,20.298999 20.928009,20.511004 21.279022,20.726001 21.768005,20.937999 22.393005,21.156001 23.08902,21.402003 23.539001,21.605006 23.740021,21.765002 23.94101,21.922999 24.042999,22.159999 24.042999,22.471003 24.042999,22.771998 23.94101,23.025996 23.740021,23.239009 23.539001,23.452006 23.222015,23.557002 22.794006,23.557002 21.878021,23.557002 21.338013,23.061 21.175995,22.070002L19.417023,22.529002C19.772003,24.103999,20.692993,24.969996,22.179993,25.122996L22.179993,26.475001 23.317993,26.475001 23.317993,25.117C24.210999,25.023005 24.893005,24.711009 25.365997,24.180995 25.83902,23.650996 26.075012,22.991008 26.075012,22.197001 26.075012,21.679004 25.960022,21.228 25.731995,20.841006 25.501007,20.456004 25.196014,20.151004 24.811005,19.932002 24.428009,19.713 23.895996,19.478999 23.222015,19.232005 22.606018,19.008006 22.205994,18.818004 22.018005,18.666003 21.830017,18.511004 21.737,18.292003 21.737,18.006999 21.737,17.726001 21.834015,17.487002 22.029999,17.290004 22.223022,17.092006 22.481018,16.995006 22.802002,16.995006 23.442993,16.995006 23.912994,17.436 24.218994,18.318004L25.787994,17.675006C25.412994,16.389003,24.588013,15.67,23.317993,15.517L23.317993,14.468004z M1.6700134,11.851999L17.184021,11.851999C16.57901,12.242998 16.015015,12.698 15.497009,13.214998 14.652008,14.060999 13.96701,15.036005 13.462006,16.112002L1.6700134,16.112002C0.74801636,16.112002,0,15.364,0,14.442003L0,13.523004C0,12.601,0.74801636,11.851999,1.6700134,11.851999z M22.748993,11.214998C27.860016,11.214998 32.003021,15.357004 32,20.475001 32,25.586009 27.856995,29.728999 22.746002,29.728999 20.718018,29.728999 18.841003,29.074 17.317017,27.967997 15.858002,26.906001 14.714996,25.426005 14.074005,23.704997 13.867004,23.157008 13.713013,22.583003 13.615997,21.988002 13.536011,21.494006 13.492004,20.989001 13.492004,20.471003 13.492004,19.516002 13.636017,18.594005 13.907013,17.725001 14.084015,17.164004 14.307007,16.626002 14.582001,16.115001 15.606995,14.194002 17.287018,12.681002 19.325012,11.869005 20.384003,11.448 21.540009,11.214998 22.748993,11.214998z M1.6700134,5.9800042L19.088013,5.9800042C20.01001,5.9800042,20.759003,6.7279977,20.759003,7.6500024L20.759003,8.5719995C20.759003,9.4940042,20.01001,10.241998,19.088013,10.241998L1.6700134,10.241998C0.74801636,10.241998,0,9.4940042,0,8.5719995L0,7.6500024C0,6.7279977,0.74801636,5.9800042,1.6700134,5.9800042z M4.3390198,0L21.757019,0C22.679016,8.7958597E-08,23.427002,0.74800125,23.427002,1.6699987L23.427002,2.5920033C23.427002,3.5140003,22.679016,4.2630009,21.757019,4.2630009L4.3390198,4.2630009C3.4170227,4.2630009,2.6690063,3.5140003,2.6690063,2.5920033L2.6690063,1.6699987C2.6690063,0.74800125,3.4170227,8.7958597E-08,4.3390198,0z"
                                                  Fill="{Binding Estado,
                                                                 Converter={StaticResource StateValueToColorConverter}}"
                                                  RenderTransformOrigin="0.5,0.5"
                                                  Stretch="Uniform"
                                                  Stroke="Gold" />
                                                </Grid>
                                            </Viewbox>
                                            <StackPanel Margin="10" Orientation="Vertical">
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource MetroColorBlack}"
                                                   Text="{Binding CodigoPrestamo}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding MontoPrestamo, StringFormat=N2}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding Estado}" />

                                                <Rectangle Height="6" Style="{StaticResource EstiloRectanguloEnListas}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="2">
                        <GroupBox Header="Prestamo">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="21" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Código Prestamo" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0" 
                                                                Text="{Binding PendingLoanSelected.CodigoPrestamo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Saldo Pendiente" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1" 
                                                                Text="{Binding PendingLoanSelected.SaldoPendiente, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        Text="Cantidad Abono" />
                                    <misControles:InputTextBox Grid.Row="1" Grid.Column="2" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding DatoAbonoPrestamo.MontoAbono,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" 
                                                               Comportamientos:TextBoxMaskBehavior.MaximumValue="18"/>
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="0"
                                        Grid.Column="3"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding CommandFullPaymentForLoan}"
                                        Imagen="{DynamicResource FullPathImagen}" />
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="1"
                                        Grid.Column="3"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding ComandoAgregarAbonoPrestamo}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />
                                    <misControles:HeaderTextBlock Grid.Row="2" Grid.ColumnSpan="4" Text="{Binding PendingLoanSelected.Observaciones}"  Foreground="Red" FontSize="11" FontWeight="Medium" />
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="3">
                        <GroupBox Header="DETALLE DE ABONOS DEL PRESTAMO">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding AssignedLoansBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding AssignedLoanBoletaSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="55">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.ComandoRemoverAbonoPrestamo, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding CodigoPrestamo}" Header="Codigo Prestamo" />
                                            <DataGridTextColumn Binding="{Binding CodigoBoleta}" Header="Boleta" />
                                            <DataGridTextColumn Binding="{Binding MontoAbono, StringFormat=N2}" Header="Cantidad Abono" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="4" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoGuardarAbonosPrestamos}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="5" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="BoletaOtrasDeduccionesFlyout"
                Width="680"
                Margin="100,0,0,0"
                Header="Otras Deducciones de Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <GroupBox Header="PAGO DE BOLETA">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width= "*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Boleta" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0" 
                                                                Text="{Binding BoletaSeleccionada.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Proveedor" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1" 
                                                                Text="{Binding BoletaSeleccionada.NombreProveedor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        Text="Total Débito" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Foreground="Red"
                                                                Text="{Binding DatoBoletaOtraDeduccion.DeduccionTotal,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="3"
                                        Text="Total Ingreso" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="3" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Foreground="Green"
                                                                Text="{Binding DatoBoletaOtraDeduccion.TotalIngreso,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="4"
                                        Text="Total a Pagar" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="4" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding DatoBoletaOtraDeduccion.TotalPagarBoleta,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="1">
                        <GroupBox Header="DETALLE DE OTRAS DEDUCCIONES">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width= "*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Monto" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"/>
                                    <misControles:InputTextBox Grid.Row="1" Grid.Column="0"
                                                               FontSize="12"
                                                               FontWeight="Bold"
                                                               Text="{Binding DatoBoletaOtraDeduccion.Monto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}"
                                                               Comportamientos:TextBoxMaskBehavior.MaximumValue="18">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="LostFocus">
                                                <i:InvokeCommandAction Command="{Binding ComandoActualizarRequerimientoLineaCredito}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </misControles:InputTextBox>
                                    <misControles:HeaderTextBlock Grid.Column="1" Grid.ColumnSpan="2" Text="Motivo" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"/>
                                    <CheckBox Grid.Column="3" IsChecked="{Binding DatoBoletaOtraDeduccion.EsDeduccionManual, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" FontWeight="SemiBold"
                                              Visibility="{Binding DatoBoletaOtraDeduccion.IsNegativeDeduction, Converter={StaticResource BoolToVisibilityConverter}}">Deducción Manual
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Click">
                                                <i:InvokeCommandAction Command="{Binding ComandoActualizarRequerimientoLineaCredito}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </CheckBox>
                                    <misControles:InputTextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"
                                                               FontSize="12"
                                                               FontWeight="Bold"
                                                               MaxLength="100"
                                                               Text="{Binding DatoBoletaOtraDeduccion.MotivoDeduccion, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    <misControles:HeaderTextBlock Grid.Column="0" Grid.Row="2" Text="Forma de Pago" TextAlignment="Center"
                                                                  FontWeight="SemiBold"
                                                                  Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="3"
                                        Grid.Column="0"                                        
                                        ItemsSource="{Binding ListaFormaPagos}"
                                        DisplayMemberPath="Descripcion"
                                        SelectedItem="{Binding FormaDePagoSeleccionadaBOD, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding DatoBoletaOtraDeduccion.FormaDePago, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="Descripcion"
                                        Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:HeaderTextBlock Text="Banco"
                                                                  Grid.Column="1" 
                                                                  Grid.Row="2"
                                                                  TextAlignment="Center" 
                                                                  FontWeight="SemiBold"
                                                                  Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        ItemsSource="{Binding ListadoBancos}"
                                        DisplayMemberPath="Descripcion"                                        
                                        SelectedItem="{Binding BancoSeleccionadoBOD, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding DatoBoletaOtraDeduccion.BancoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="BancoId"
                                        IsEnabled="{Binding FormaDePagoSeleccionada.RequiereBanco,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:HeaderTextBlock Grid.Column="2" Grid.Row="2" Text="Linea Crédito" TextAlignment="Center"
                                                                  FontWeight="SemiBold"
                                                                  Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <ComboBox Margin="5"
                                              Grid.Row="3"
                                              Grid.Column="2"
                                              HorizontalContentAlignment="Center" 
                                              ItemsSource="{Binding LineasCredito}"
                                              SelectedItem="{Binding LineaCreditoSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValue="{Binding DatoBoletaOtraDeduccion.LineaCreditoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValuePath="LineaCreditoId"
                                              Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Margin="5" Grid.Column="0" Text="{Binding CodigoLineaCredito}"/>
                                                    <TextBlock Margin="5" Grid.Column="1" Text="{Binding CuentaFinanciera}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <misControles:HeaderTextBlock Text="No Ref"
                                                                  Grid.Column="3" 
                                                                  Grid.Row="2"
                                                                  TextAlignment="Center" 
                                                                  FontWeight="SemiBold"
                                                                  Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:InputTextBox Grid.Row="3" Grid.Column="3"
                                                               FontSize="12"
                                                               FontWeight="Bold"
                                                               MaxLength="50"
                                                               Text="{Binding DatoBoletaOtraDeduccion.NoDocumento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                               Visibility="{Binding DatoBoletaOtraDeduccion.RequiereLineaCredito, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="1"
                                        Grid.Column="4"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding ComandoAgregarBoletaOtraDeduccion}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />
                                </Grid>
                                <Grid Grid.Row="1">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding ListaBoletaOtrasDeduccionesModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding BoletaOtraDeduccionSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="25">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.ComandoRemoverOtraDeduccion, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding MotivoDeduccion}" Header="Motivo" />
                                            <DataGridTextColumn Binding="{Binding Monto, StringFormat=N2}" Header="Monto" />
                                            <DataGridTextColumn Binding="{Binding CodigoLineaCredito}" Header="Linea Crédito" />
                                            <DataGridTextColumn Binding="{Binding FormaDePago}" Header="Forma Pago" />
                                            <DataGridTextColumn Binding="{Binding NombreBanco}" Header="Banco" />
                                            <DataGridTextColumn Binding="{Binding NoDocumento}" Header="No Ref" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="2" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding ComandoGuardarOtrasDeducciones}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="3" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="HumidityPaymentsFlyout"
                Width="650"
                Margin="100,0,0,0"
                Header="Pago de Boletas con Humedad"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                        </Grid.RowDefinitions>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="0"
                                                             Text="Proveedor"
                                                FontSize="14"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0"
                                                             Text="{Binding BoletaSeleccionada.NombreProveedor}"
                                                FontSize="14"
                                                FontWeight="Bold"                                           
                                                Foreground="Orange"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="1"
                                                             Text="Total Cobrado"
                                                FontSize="14"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1"
                                                             Text="{Binding DatoBoletaHumidityPayment.TotalHumidityPayment, StringFormat=N2}"
                                                             FontSize="14"
                                                             FontWeight="Bold"                                           
                                                             Foreground="Orange"/>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <GroupBox Header="Boletas con Humedad Pendientes" Grid.Column="0">
                            <ListBox Grid.Row="1"
                             Margin="5"
                             ItemsSource="{Binding BoletasHumidityByVendor,
                                                   Mode=TwoWay,
                                                   UpdateSourceTrigger=PropertyChanged}"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             SelectedItem="{Binding BoletaHumidityByVendorSelected,
                                                    Mode=TwoWay,
                                                    UpdateSourceTrigger=PropertyChanged}">

                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel IsItemsHost="True" Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>

                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox Margin="2">
                                                <Grid Width="25">
                                                    <Path Data="M10.058927,10.900028C11.158908,13.400034 9.8589301,15.200039 9.8589301,15.200039 9.5589354,15.900041 9.4589369,16.400042 9.4589369,16.400042 9.058944,19.200049 11.158908,19.60005 11.158908,19.60005 13.258872,19.90005 13.758863,17.800045 13.758863,17.800045 14.958843,14.300036 10.058927,10.900028 10.058927,10.900028z M2.3590581,0C2.3590584,0 21.958723,12.300032 17.4588,25.500064 17.4588,25.500065 15.358836,32.900083 7.0589778,31.900081 7.0589781,31.900081 -1.24088,30.500077 0.15909624,20.200051 0.15909624,20.200051 0.35909271,18.400047 1.6590705,15.80004 1.6590705,15.80004 6.5589866,8.6000223 2.3590581,0z"
                                                  Fill="{Binding Estado,
                                                                 Converter={StaticResource StateValueToColorConverter}}"
                                                  RenderTransformOrigin="0.5,0.5"
                                                  Stretch="Uniform"
                                                  Stroke="Gold" />
                                                </Grid>
                                            </Viewbox>
                                            <StackPanel Margin="10" Orientation="Vertical">
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource MetroColorBlack}"
                                                   Text="{Binding NumeroEnvio}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding OutStandingPay, StringFormat=N2}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding NombrePlanta}" />

                                                <Rectangle Height="6" Style="{StaticResource EstiloRectanguloEnListas}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                        <Grid Grid.Column="1" HorizontalAlignment="Right">
                            <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="1"
                                        Grid.Column="3"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding CommandAddHumidityPayment}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="2">
                        <GroupBox Header="DETALLE DE Boletas con Humedad a Cobrar">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding BoletaHumedadPagoModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding BoletaHumidityPaymentSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="25">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.CommandRemoveHumidityPayment, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding NumeroEnvio}" Header="#Envío" />
                                            <DataGridTextColumn Binding="{Binding HumedadPromedio, StringFormat=N2}" Header="Promedio" />
                                            <DataGridTextColumn Binding="{Binding PorcentajeTolerancia, StringFormat=N2}" Header="Tolerancia" />
                                            <DataGridTextColumn Binding="{Binding TotalHumidityPayment, StringFormat=N2}" Header="Monto" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="3" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding CommandSaveHimidityPayments}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="5" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="FuelOrderFlyout"
                Width="580"
                Margin="100,0,0,0"
                Header="Ordenes de Combustible"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="70"/>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120*" />
                                            <ColumnDefinition Width="100*"/>
                                            <ColumnDefinition Width="100*"/>
                                            <ColumnDefinition Width="100*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                        </Grid.RowDefinitions>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="0"
                                                                  Text="Proveedor"
                                                                  FontSize="13"
                                                                  FontWeight="SemiBold" Height="18" Margin="5,6"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0"
                                                             Text="{Binding BoletaSeleccionada.NombreProveedor}"
                                                FontSize="12"
                                                FontWeight="Bold"                                           
                                                Foreground="Orange"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="1"
                                                                  Text="Boleta"
                                                                  FontSize="12"
                                                                  FontWeight="SemiBold" Height="18" Margin="5,6"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1"
                                                             Text="{Binding BoletaSeleccionada.CodigoBoleta, StringFormat=N2}"
                                                             FontSize="12"
                                                             FontWeight="Bold"                                           
                                                             Foreground="Orange"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="2"
                                                                  Text="Asignado"
                                                                  FontSize="12"
                                                                  FontWeight="SemiBold" Height="18" Margin="5,6"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2"
                                                             Text="{Binding FuelOrderDato.TotalAsignaciones, StringFormat=N2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             FontSize="12"
                                                             FontWeight="Bold"                                           
                                                             Foreground="Orange"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="3"
                                                                  Text="Saldo Boleta"
                                                                  FontSize="12"
                                                                  FontWeight="SemiBold" Height="18" Margin="5,6"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="3"
                                                             Text="{Binding FuelOrderDato.BoletaSaldo, StringFormat=N2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                             FontSize="12"
                                                             FontWeight="Bold"                                           
                                                             Foreground="Orange"/>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <GroupBox Header="Ordenes de Combustible Pendiente">
                            <ListBox Grid.Row="1" Grid.Column="0"
                             Margin="5"
                             ItemsSource="{Binding FuelOrdersPending,
                                                   Mode=TwoWay,
                                                   UpdateSourceTrigger=PropertyChanged}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             SelectedItem="{Binding FuelOrderPendingSelected,
                                                    Mode=TwoWay,
                                                    UpdateSourceTrigger=PropertyChanged}">

                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel IsItemsHost="True" Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>

                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox Margin="2">
                                                <Grid Width="25">
                                                    <Path Data="M0,29.299994L24.000108,29.299994 24.000108,31.999992 0,31.999992z M17.900081,10.699998C17.400079,10.699998 16.900076,11.099998 16.900076,11.699998 16.900076,12.199997 17.300078,12.699997 17.900081,12.699997 18.400083,12.699997 18.900085,12.299997 18.900085,11.699998 18.900085,11.099998 18.400083,10.699998 17.900081,10.699998z M12.300056,10.699998C11.800053,10.699998 11.300051,11.099998 11.300051,11.699998 11.300051,12.199997 11.700053,12.699997 12.300056,12.699997 12.800058,12.699997 13.30006,12.299997 13.30006,11.699998 13.200059,11.099998 12.800058,10.699998 12.300056,10.699998z M7.0000315,10.699998C6.5000293,10.699998 6.0000271,11.099998 6.0000269,11.699998 6.0000271,12.199997 6.4000288,12.699997 7.0000315,12.699997 7.5000338,12.699997 8.0000361,12.299997 8.000036,11.699998 8.0000361,11.099998 7.5000338,10.699998 7.0000315,10.699998z M26.900121,6.8999987L26.400119,7.5999985 26.70012,8.7999983 27.400123,8.5999985z M5.4000244,2C4.8000216,2,4.0000181,2.1000004,4.0000179,2.6999989L4.0000179,7.9999981C4.0000181,8.4999981,4.8000216,9.2999983,5.4000244,9.2999983L19.500088,9.2999983C20.000091,9.2999983,20.000091,8.5999985,20.000091,7.9999981L20.000091,2.6999989C20.000091,2.1000004,20.000091,2,19.400087,2z M4.2000191,0L20.400092,0C21.300096,0,22.000099,0.10000038,22.000099,1L22.000099,4 22.700102,4 22.700102,10.699998 22.000099,10.699998 22.000099,14.899997C23.400105,15.599997 23.900107,17.199996 24.100108,18.799996 24.400109,20.799995 24.60011,23.199995 26.000117,24.799994 27.600125,26.599994 29.400132,24.599994 29.500133,22.799995 29.600133,21.299995 29.400132,19.699996 29.000131,18.199996 28.300128,15.499997 27.400123,12.799997 27.500123,9.9999981L27.500123,9.7999983 26.300118,10.099998 25.700116,7.2999983 27.100121,5.7999992 26.70012,4C26.60012,3.7999992,26.70012,3.5999985,26.80012,3.5L27.300122,3.3999996C27.400123,3.3999996,27.600125,3.5999985,27.600125,3.7999992L28.80013,9.0999985C28.90013,9.2999983,28.80013,9.5999975,28.600129,9.5999975L28.100127,9.6999979C27.800126,13.599997 29.700133,17.199996 30.100135,21.099995 30.300136,22.899995 29.700133,25.899994 27.400123,26.099994 25.400115,26.199994 24.400109,23.799995 24.000108,22.199995 23.500106,20.299995 23.700107,16.899996 22.000099,15.599997L22.000099,28.799994 2.0000091,28.799994 2.0000091,1C2.0000091,0.10000038,3.300015,0,4.2000191,0z"
                                                  Fill="{Binding Estado,
                                                                 Converter={StaticResource StateValueToColorConverter}}"
                                                  RenderTransformOrigin="0.5,0.5"
                                                  Stretch="Uniform"
                                                  Stroke="Gold" />
                                                </Grid>
                                            </Viewbox>
                                            <StackPanel Margin="10" Orientation="Vertical">
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource MetroColorBlack}"
                                                   Text="{Binding CodigoFactura}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding PlacaEquipo}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding Monto, StringFormat=N2}" />
                                                <Rectangle Height="6" Style="{StaticResource EstiloRectanguloEnListas}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                        <misControles:HeaderTextBlock Grid.Row="1" Text="{Binding FuelOrderPendingSelected.FuelOrderSpecification}" Foreground="Red" FontSize="11" FontWeight="Medium" />
                        <Grid Grid.Column="1" HorizontalAlignment="Right">
                            <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="1"
                                        Grid.Column="3"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding CommandAddFuelOrder}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="2">
                        <GroupBox Header="DETALLE de Asignaciones">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding FuelOrdersAssigned, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding FuelOrderAssignedSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="25">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.CommandRemoveFuelOrder, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding CodigoFactura}" Header="#Factura" />
                                            <DataGridTextColumn Binding="{Binding AutorizadoPor}" Header="Autorizado" />
                                            <DataGridTextColumn Binding="{Binding PlacaEquipo}" Header="#Placa" />
                                            <DataGridTemplateColumn Header="Monto">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Monto, StringFormat=N2}" HorizontalAlignment="Right"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding Observaciones}" Header="Observaciones" />
                                            <DataGridTextColumn Binding="{Binding FechaCreacion, StringFormat=D}" Header="Fecha" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="3" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding CommandSaveFuelOrders}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="5" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="AjusteBoletaPaymentslyout"
                Width="650"
                Margin="100,0,0,0"
                Header="Pago de Ajuste de Boletas"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="60"/>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid Grid.Row="0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*" />
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                            <RowDefinition Height="Auto" MinHeight="30" />
                                        </Grid.RowDefinitions>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="0"
                                                                  Text="Proveedor"
                                                                  FontSize="14"
                                                                  FontWeight="SemiBold"
                                                                  HorizontalAlignment="Center"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0"
                                                                    Text="{Binding BoletaSeleccionada.NombreProveedor}"
                                                                    FontSize="14"
                                                                    FontWeight="Bold"                                           
                                                                    Foreground="Orange"
                                                                    HorizontalAlignment="Center"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="1"
                                                               Text="Total Abono"
                                                               HorizontalAlignment="Center"
                                                               FontSize="14"
                                                                  FontWeight="SemiBold"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1"
                                                                    Text="{Binding AjusteBoletaPaymentDato.TotalPayments, StringFormat=N2}"
                                                                    FontSize="14"
                                                                    FontWeight="Bold"                                           
                                                                    Foreground="Orange"
                                                                    HorizontalAlignment="Center"/>
                                        <misControles:HeaderTextBlock Grid.Row="0" Grid.Column="2"
                                                             Text="Total a Pagar"
                                                             FontSize="14"
                                                             HorizontalAlignment="Center"
                                                                  FontWeight="SemiBold"/>
                                        <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2"
                                                                    Text="{Binding AjusteBoletaPaymentDato.SaldoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}"
                                                                    FontSize="14"
                                                                    FontWeight="Bold"                                           
                                                                    Foreground="Orange"
                                                                    HorizontalAlignment="Center"/>
                                    </Grid>
                                </Grid>
                            </Grid>
                        </Grid>
                    </Grid>
                    <Grid Grid.Row="1">
                        <GroupBox Header="Ajuste de Boletas Pendientes">
                            <ListBox Grid.Row="1"
                             Margin="5"
                             ItemsSource="{Binding AjusteBoletaDetalles,
                                                   Mode=TwoWay,
                                                   UpdateSourceTrigger=PropertyChanged}"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             SelectedItem="{Binding AjusteBoletaDetalleSelected,
                                                    Mode=TwoWay,
                                                    UpdateSourceTrigger=PropertyChanged}">

                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel IsItemsHost="True" Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>

                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Viewbox Margin="2">
                                                <Grid Width="25">
                                                    <Path Data="M4.0500023,22.614998L4.0500023,25.118 7.3729998,25.118 7.3729998,22.614998z M22.759,17.995998L22.759,19.301998C21.289998,19.59 20.436994,20.538998 20.436994,21.747997 20.436994,23.080997 21.440992,23.768997 22.910993,24.263 23.927991,24.606998 24.367994,24.937 24.367994,25.458 24.367994,26.007999 23.831998,26.310997 23.048993,26.310997 22.154996,26.310997 21.344999,26.022999 20.767995,25.706997L20.354993,27.313999C20.876996,27.615997,21.770993,27.863998,22.691999,27.904999L22.691999,29.209999 24.037992,29.209999 24.037992,27.808998C25.619001,27.534 26.483991,26.488998 26.483991,25.266998 26.483991,24.029999 25.824002,23.273998 24.188993,22.696999 23.020002,22.257 22.539991,21.968998 22.539991,21.514999 22.539991,21.128998 22.828992,20.744999 23.72099,20.744999 24.710996,20.744999 25.341993,21.060997 25.701001,21.210999L26.097989,19.659C25.645993,19.439999,25.02699,19.246998,24.106992,19.205997L24.106992,17.995998z M23.419004,16.041C27.594999,16.041 30.980998,19.426998 30.980998,23.603001 30.980998,27.778999 27.594999,31.164997 23.419004,31.164997 19.241994,31.164997 15.857001,27.778999 15.857001,23.603001 15.857001,19.426998 19.241994,16.041 23.419004,16.041z M4.0500023,15.784L4.0500023,18.286999 7.3729998,18.286999 7.3729998,15.784z M4.0500023,9.185997L4.0500023,11.688999 7.3729998,11.688999 7.3729998,9.185997z M9.2819969,9.1559982L9.2819969,11.657997 19.368993,11.657997 19.368993,9.1559982z M17.849996,0.096000671L23.419004,7.8219986 16.392995,3.4899979z M0,0L16.367994,0 14.411001,4.4580002 23.341993,9.4899979 23.341993,14.792999C21.910993,14.806,20.562993,15.162998,19.37,15.782997L19.37,15.753998 9.2819969,15.753998 9.2819969,18.257 16.428998,18.257C15.484999,19.487,14.856001,20.968998,14.668997,22.585999L9.2819969,22.585999 9.2819969,25.089001 14.740996,25.089001C15.298994,28.354,17.650998,31.011997,20.748998,32L0,32z"
                                                  Fill="{Binding Estado,
                                                                 Converter={StaticResource StateValueToColorConverter}}"
                                                  RenderTransformOrigin="0.5,0.5"
                                                  Stretch="Uniform"/>
                                                </Grid>
                                            </Viewbox>
                                            <StackPanel Margin="10" Orientation="Vertical">
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource MetroColorBlack}"
                                                   Text="{Binding CodigoBoleta}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding NumeroEnvio}" />
                                                <TextBlock Margin="1"
                                                   HorizontalAlignment="Stretch"
                                                   FontSize="12"
                                                   FontWeight="Bold"
                                                   Foreground="{Binding Estado,
                                                                        Converter={StaticResource StateValueToColorConverter}}"
                                                   Text="{Binding Monto, StringFormat=N2}" />

                                                <Rectangle Height="6" Style="{StaticResource EstiloRectanguloEnListas}" />
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="2">
                        <GroupBox Header="Pago de Ajuste">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="24" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Código Boleta" 
                                                              HorizontalAlignment="Center"
                                                              FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0" 
                                                                Text="{Binding AjusteBoletaDetalleSelected.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="# Envío"
                                                              HorizontalAlignment="Center"
                                                              FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1" 
                                                                Text="{Binding AjusteBoletaDetalleSelected.NumeroEnvio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="2" Text="Saldo Pendiente" 
                                                              HorizontalAlignment="Center"
                                                              FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2" 
                                                                Text="{Binding AjusteBoletaDetalleSelected.SaldoPendiente, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="3"
                                        Text="Cantidad Abono"
                                    HorizontalAlignment="Center"
                                    FontWeight="SemiBold"/>
                                    <misControles:InputTextBox Grid.Row="1" Grid.Column="3" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding AjusteBoletaPaymentDato.Monto,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" 
                                                               Comportamientos:TextBoxMaskBehavior.MaximumValue="18"/>
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="1"
                                        Grid.Column="4"
                                        Width="21"
                                        Height="21"
                                        Margin="5"
                                        HorizontalAlignment="Left"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding CommandAddAjustePayment}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />
                                    <misControles:HeaderTextBlock Grid.Row="2" Grid.ColumnSpan="4" Text="{Binding AjusteBoletaDetalleSelected.CadenaAjuste}"  Foreground="Red" FontSize="11" FontWeight="Medium" />
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="3">
                        <GroupBox Header="DETALLE DE PAGOS">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding AjusteBoletaPayments, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding AjusteBoletaPaymentSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="55">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.CommandDeleteAjustePayment, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding BoletasViewModel.CommandEditAjustePayment, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource EditarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding CodigoBoleta}" Header="#Boleta" />
                                            <DataGridTextColumn Binding="{Binding NumeroEnvio}" Header="#Envío" />
                                            <DataGridTextColumn Binding="{Binding Monto, StringFormat=N2}" Header="Monto" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="4" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding CommandSaveAjustePayments}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="5" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="UpdateBoletaPropertiesFlyout"
                Width="400"                
                Margin="100,0,0,0"
                Header="Editar Propiedades de Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Orientation="Vertical">
                            <StackPanel Margin="5" Grid.Row="0">
                                <Grid
                                    Height="156"
            						Width="90"            						
            						HorizontalAlignment="Center"
            						Background="LightGray">
                                    <Image
                                        RenderOptions.BitmapScalingMode="Fant"
                                       Stretch="Fill"
                                       Height="156"
            						   Width="90"
                                       VerticalAlignment="Top"
                                       Margin="0,0,0,0"
                                       HorizontalAlignment="Center"
            							Source="{Binding DatoBoleta.Imagen, Converter={StaticResource BinaryImageConverter}, Mode=TwoWay}" />
                                </Grid>

                                <Button
            						Width="80"
            						Margin="5"
            						HorizontalAlignment="Center"
            						Command="{Binding CommandSelectImage}"
            						Content="Seleccionar" />
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Planta Destino" />
                            <misControles:InputTextBoxAutoCompleteControl
									SelectedItem="{Binding PlantaAutoCompleteSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
									Buscar="{Binding ComandoBuscarPlantas}"
                                    AutoCompletionList="{Binding ListaPlantasAutoComplete}"/>
                            <misControles:HeaderTextBlock Text="Código Boleta" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <StackPanel Visibility="{Binding DatoBoleta.IsShippingNumberRequired, Converter={StaticResource BoolToVisibilityConverter}}">
                                <misControles:HeaderTextBlock Text="Número de Envío" />
                                <misControles:InputTextBox Text="{Binding DatoBoleta.NumeroEnvio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Nombre del Proveedor" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaProveedoresAutoComplete}"
                                    Buscar="{Binding ComandoBuscarProveedores}"
                                    SelectedItem="{Binding ProveedorAutoCompleteSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />                            
                            <misControles:HeaderTextBlock Text="Nombre del Motorista" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.Motorista, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="50"/>
                            <misControles:HeaderTextBlock Text="Placa Cabezal" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.PlacaEquipo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" MaxLength="10"/>
                            <misControles:HeaderTextBlock Text="Tipo Producto" />
                            <misControles:InputTextBoxAutoCompleteControl
                                    AutoCompletionList="{Binding ListaCategoriaProductos}"
                                    Buscar="{Binding ComandoBuscarCategoriaProductos}"
                                    SelectedItem="{Binding CategoriaProductoAutoCompleteSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="Precio Producto" />
                            <misControles:InputTextBox Text="{Binding DatoBoleta.PrecioProductoCompra,
                                                               Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" 
                                                       FontSize="12"
                                                       FontWeight="Bold"
                                                       Comportamientos:TextBoxMaskBehavior.MaximumValue="18"/>
                            <misControles:HeaderTextBlock Text="Peso Entrada (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.PesoEntrada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <misControles:HeaderTextBlock Text="Peso Salida (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.PesoSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <misControles:HeaderTextBlock Text="Cantidad Penalizada (t)" />
                            <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.CantidadPenalizada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="LostFocus">
                                        <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </misControles:InputTextBox>
                            <StackPanel Visibility="{Binding DatoBoleta.IsBonusEnable, Converter={StaticResource BoolToVisibilityConverter}}">
                                <CheckBox Margin="5" IsChecked="{Binding DatoBoleta.HasBonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">Tiene Bonificación?</CheckBox>
                                <misControles:HeaderTextBlock Text="Bonificación (t)" />
                                <misControles:InputTextBox    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Comportamientos:TextBoxMaskBehavior.MaximumValue="18"
                                Text="{Binding DatoBoleta.Bonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}"
                                Visibility="{Binding DatoBoleta.HasBonus, Converter={StaticResource BoolToVisibilityConverter}}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="LostFocus">
                                            <i:InvokeCommandAction Command="{Binding ComandoCalcularPesoNeto}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </misControles:InputTextBox>
                            </StackPanel>
                            <misControles:HeaderTextBlock Text="Peso Neto (t)" />
                            <misControles:BodyTextBlock    
                                Width="100"
                                HorizontalAlignment="Left"
                                FontSize="12"
                                FontWeight="Bold"
                                Text="{Binding DatoBoleta.PesoProducto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged,StringFormat=N2}" />
                            <misControles:HeaderTextBlock Text="Fecha de Salida" />
                            <DatePicker Margin="5" SelectedDate="{Binding DatoBoleta.FechaSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </ScrollViewer>
                    <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding CommandSavePropertiesBoleta}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
        </controlsMahApps:FlyoutsControl>
    </wpfCoreWindow:MetroWindowExt.Flyouts>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="70" />
        </Grid.RowDefinitions>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="275" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <GroupBox Header="Busqueda Boletas">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="400*" />
                        <RowDefinition Height="33*" />
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <misControles:TitleTextBlock Text="Buscar" />
                        <misControles:SearchTextBox
							Grid.Row="1"
							Buscar="{Binding ComandoBuscar}"
							SpellCheck.IsEnabled="True"
							Text="{Binding ValorBusquedaBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                    </Grid>
                    <ListBox
                        Grid.Row="1"
                        Margin="5"
                        IsSynchronizedWithCurrentItem="True"
                        ItemsSource="{Binding BusquedaBoletasControl.Items}"
                        SelectedItem="{Binding BoletaSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Viewbox Margin="2">
                                        <Grid Width="25">
                                            <Path
                                                Fill="{Binding Estado, Converter={StaticResource StateValueToColorConverter}}"
                                                Data="M15,25.010004L19,25.010004C19.552,25.010004 20,25.458004 20,26.010004 20,26.562004 19.552,27.010004 19,27.010004L15,27.010004C14.448,27.010004 14,26.562004 14,26.010004 14,25.458004 14.448,25.010004 15,25.010004z M6,22L6,26 10,26 10,22z M15,21.010004L19,21.010004C19.552,21.010004 20,21.458004 20,22.010004 20,22.562004 19.552,23.010004 19,23.010004L15,23.010004C14.448,23.010004 14,22.562004 14,22.010004 14,21.458004 14.448,21.010004 15,21.010004z M4,20L12,20 12,28 4,28z M15,14.010004L19,14.010004C19.552,14.010004 20,14.458004 20,15.010004 20,15.562004 19.552,16.010004 19,16.010004L15,16.010004C14.448,16.010004 14,15.562004 14,15.010004 14,14.458004 14.448,14.010004 15,14.010004z M6,11L6,15 10,15 10,11z M15,10.010004L19,10.010004C19.552,10.010004 20,10.458004 20,11.010004 20,11.562004 19.552,12.010004 19,12.010004L15,12.010004C14.448,12.010004 14,11.562004 14,11.010004 14,10.458004 14.448,10.010004 15,10.010004z M4,9L12,9 12,17 4,17z M18,2.4139996L18,6.0309906 21.616991,6.0309906z M2,2L2,30 22,30 22,8.0309887 16,8.0309887 16,2z M2,0L18.414,0 24,5.5860004 24,30C24,31.103,23.103001,32,22,32L2,32C0.89700007,32,0,31.103,0,30L0,2C0,0.89699936,0.89700007,0,2,0z"
                                                RenderTransformOrigin="0.5,0.5"
                                                Stretch="Uniform" />
                                        </Grid>
                                    </Viewbox>
                                    <StackPanel
                                        Width="185"
                                        Margin="5"
                                        Orientation="Vertical">
                                        <TextBlock
                                            Margin="1"
                                            HorizontalAlignment="Stretch"
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Text="{Binding CodigoBoleta}"
                                            TextWrapping="Wrap" />
                                        <TextBlock
                                            Margin="1"
                                            HorizontalAlignment="Stretch"
                                            FontSize="10"
                                            Text="{Binding NombreProveedor}"
                                            TextWrapping="Wrap" />
                                        <TextBlock
                                            Margin="1"
                                            HorizontalAlignment="Stretch"
                                            Foreground="{Binding Estado, Converter={StaticResource StateValueToColorConverter}}"
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Text="{Binding Estado}"
                                            TextWrapping="Wrap" />
                                        <Rectangle Height="6" Style="{StaticResource EstiloRectanguloEnListas}" />
                                    </StackPanel>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <misControles:PaginarControl
						Grid.Row="2"
						Width="170"
						Background="{DynamicResource AccentColorBrush}"
						ComandoAnterior="{Binding ComandoNavegar}"
						ComandoSiguiente="{Binding ComandoNavegar}"
						NumeroPagina="{Binding NumeroPagina, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
						TotalPaginas="{Binding BusquedaBoletasControl.TotalPagina}" />
                </Grid>
            </GroupBox>
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                </Grid.RowDefinitions>
                <GroupBox Header="Datos Generales de la Boleta">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition MinWidth="180" Width="*"  />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition MinWidth="120" Width="160"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" MinHeight="28" />
                            <RowDefinition Height="Auto" MinHeight="28" />
                            <RowDefinition Height="Auto" MinHeight="28" />
                            <RowDefinition Height="Auto" MinHeight="28" />
                            <RowDefinition Height="Auto" MinHeight="28" />
                            <RowDefinition Height="Auto" MinHeight="28" />
                            <RowDefinition Height="Auto" MinHeight="28"/>
                            <RowDefinition Height="Auto" MinHeight="28" />
                        </Grid.RowDefinitions>
                        <Grid Margin="5"
                               Grid.Column="4"
                               Grid.Row="0"
                               Grid.RowSpan="8">
                            <controlsMahApps:Tile x:Name="VerticalFormat" Height="256" Width="190" HorizontalAlignment="Left"
                                                  Visibility="{Binding BoletaSeleccionada.IsHorizontalImg, ConverterParameter=INVERTIR,  Converter={StaticResource BoolToVisibilityConverter}}">
                                <controlsMahApps:Tile.Background>
                                    <ImageBrush ImageSource="{Binding BoletaSeleccionada.Imagen, Converter={StaticResource BinaryImageConverter}, 
                                            Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Stretch="UniformToFill" 
                                            RenderOptions.BitmapScalingMode="HighQuality"/>
                                </controlsMahApps:Tile.Background>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:InvokeCommandAction Command="{Binding CommandSaveAndOpenImage}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </controlsMahApps:Tile>
                            <controlsMahApps:Tile x:Name="HorizontalFormat" Height="200" Width="256" HorizontalAlignment="Left"
                                                  Visibility="{Binding BoletaSeleccionada.IsHorizontalImg,  Converter={StaticResource BoolToVisibilityConverter}}">
                                <controlsMahApps:Tile.Background>
                                    <ImageBrush ImageSource="{Binding BoletaSeleccionada.Imagen, Converter={StaticResource BinaryImageConverter}, 
                                            Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            Stretch="UniformToFill" 
                                            RenderOptions.BitmapScalingMode="HighQuality"/>
                                </controlsMahApps:Tile.Background>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <i:InvokeCommandAction Command="{Binding CommandSaveAndOpenImage}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </controlsMahApps:Tile>
                        </Grid>
                        <misControles:HeaderTextBlock
							Margin="5"
							Text="Codigo de la Boleta"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Column="1"
                            Foreground="Black"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Margin="5"
                            Grid.Column="2"
                            Grid.Row="0"
							Text="Numero de Envío"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Column="3"
                            Grid.Row="0"
                            Foreground="Black"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.NumeroEnvio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
                            Grid.Row="1"
							Margin="5"
							Text="Placa Cabezal"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
                            Grid.Row="1"
							Grid.Column="1"
							Margin="5"
                            VerticalAlignment="Center"
							Text="{Binding BoletaSeleccionada.PlacaEquipo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
                            Grid.Row="1"
                            Grid.Column="2"
							Margin="5"
							Text="Motorista"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
                            Grid.Row="1"
							Grid.Column="3"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.Motorista, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="2"
							Margin="5"
							Text="Planta"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="2"
							Grid.Column="1"
                            Foreground="Black"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.NombrePlanta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="2"
                            Grid.Column="2"
							Margin="5"
							Text="Tipo Producto"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="2"
							Grid.Column="3"
                            Foreground="Black"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.DescripcionTipoProducto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="3"
							Margin="5"
							Text="Proveedor"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="3"
							Grid.Column="1"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.NombreProveedor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="3"
                            Grid.Column="2"
							Margin="5"
							Text="Precio Producto"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="3"
							Grid.Column="3"
                            Foreground="Black"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.PrecioProductoCompra, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="4"
							Margin="5"
							Text="Peso Producto"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="4"
							Grid.Column="1"
							Margin="5"
                            VerticalAlignment="Center"
                            Foreground="Black"
                            FontWeight="SemiBold"
							Text="{Binding BoletaSeleccionada.PesoProducto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="4"
                            Grid.Column="2"
							Margin="5"
							Text="Bonificación"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="4"
							Grid.Column="3"
                            Foreground="Green"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.Bonus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                        <misControles:HeaderTextBlock
							Grid.Row="5"
                            Grid.Column="0"
							Margin="5"
							Text="Penalización"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="5"
							Grid.Column="1"
                            Foreground="Red"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"
							Text="{Binding BoletaSeleccionada.CantidadPenalizada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                        <misControles:HeaderTextBlock
							Grid.Row="5"
                            Grid.Column="2"
							Margin="5"
							Text="Total Toneladas"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="5"
							Grid.Column="3"
                            Foreground="Black"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
							Margin="5"                            
							Text="{Binding BoletaSeleccionada.TotalToneladas, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                        <misControles:HeaderTextBlock
							Grid.Row="7"
							Margin="5"
							Text="Fecha Salida"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="7"
							Grid.Column="1"
                            Margin="5"
                            VerticalAlignment="Center"
							Text="{Binding BoletaSeleccionada.FechaSalida, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=D}" />
                        <misControles:HeaderTextBlock
							Grid.Row="6"
							Margin="5"
							Text="Nombre Cuadrilla"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="6"
							Grid.Column="1"
                            VerticalAlignment="Center"
                            Margin="5"
							Text="{Binding BoletaSeleccionada.NombreDescargador, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        <misControles:HeaderTextBlock
							Grid.Row="6"
                            Grid.Column="2"
							Margin="5"
							Text="Auto-Asignada"
							TextWrapping="Wrap" />
                        <misControles:BodyTextBlock
							Grid.Row="6"
							Grid.Column="3"
                            VerticalAlignment="Center"
                            Margin="5"
							Text="{Binding BoletaSeleccionada.IsDescargaAdelanto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat=N2}" />
                        <misControles:HeaderTextBlock
							Grid.Row="7"
                            Grid.Column="2"
                            Margin="5"
							Text="#Factura"
							TextWrapping="Wrap"/>
                        <misControles:BodyTextBlock
							Grid.Row="7"
							Grid.Column="3"
                            Foreground="Green"
                            FontWeight="SemiBold"
							Text="{Binding BoletaSeleccionada.FacturaNo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                            Visibility="{Binding BoletaSeleccionada.IsAssignedInvoice, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        <misControles:BodyTextBlock
							Grid.Row="7"
							Grid.Column="3"
                            Foreground="Red"
                            FontWeight="SemiBold"
                            VerticalAlignment="Center"
                            Margin="5"
							Text="{Binding BoletaSeleccionada.FacturaNo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                            Visibility="{Binding BoletaSeleccionada.IsAssignedInvoice, ConverterParameter=INVERTIR, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    </Grid>
                </GroupBox>
                <TabControl Grid.Row="1">
                    <TabItem controlsMahApps:ControlsHelper.HeaderFontSize="16" Header="Deducciones">
                        <Grid>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <DataGrid
									AutoGenerateColumns="False"
									IsReadOnly="True"
									ItemsSource="{Binding ListaBoletaDetalles}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding DescripcionDeduccion}" Header="Descripción Deducción" />
                                        <DataGridTemplateColumn Header="Monto">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding MontoDeduccion, StringFormat=N2}" HorizontalAlignment="Right"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTextColumn Binding="{Binding NoDocumento}" Header="Referencia" />
                                        <DataGridTextColumn Binding="{Binding Observaciones}" Header="Observaciones" />
                                        <DataGridTextColumn Binding="{Binding ModificadoPor}" Header="User"  />
                                        <DataGridTextColumn Binding="{Binding FechaTransaccion, StringFormat=D}" Header="Fecha" />
                                    </DataGrid.Columns>
                                </DataGrid>
                                <Grid Grid.Row="1" HorizontalAlignment="Right">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" MinWidth="60" />
                                        <ColumnDefinition Width="15"/>
                                    </Grid.ColumnDefinitions>
                                    <misControles:HeaderTextBlock Grid.Row="0"
                                                                 FontSize="14"
                                                                 Text="Total Factura"
                                                                  FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="0"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding BoletaSeleccionada.TotalFacturaCompra,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right" />
                                    <misControles:HeaderTextBlock Grid.Row="1"
                                                                 FontSize="14"
                                                                 Text="Total Deducciones (-)"
                                                                  FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding BoletaSeleccionada.TotalDeduccion,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right"
                                                                Foreground="Red"/>
                                    <misControles:HeaderTextBlock Grid.Row="2"
                                                                 FontSize="14"
                                                                 Text="Otros Ingresos (+)"
                                                                  FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="2"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding BoletaSeleccionada.TotalOtrosIngresosBoleta,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right"
                                                                Foreground="Green"/>
                                    <misControles:HeaderTextBlock Grid.Row="3"
                                                                 FontSize="14"
                                                                 Text="Total a Pagar"
                                                                  FontWeight="SemiBold"/>
                                    <misControles:BodyTextBlock Grid.Row="3"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding BoletaSeleccionada.TotalAPagar,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right" />
                                </Grid>
                                <Grid Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                    </Grid.ColumnDefinitions>                                    
                                    <misControles:HeaderTextBlock Grid.Row="0"
                                                                  FontSize="14"
                                                                  FontWeight="DemiBold"
                                                                  HorizontalAlignment="Left"
                                                                  Foreground="Red"
                                                                  Text="El Proveedor tiene Préstamos Pendiente" Grid.Column="0"
                                                                  Visibility="{Binding BoletaSeleccionada.ClientHasLoan, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:HeaderTextBlock Grid.Row="1"
                                                                  FontSize="14"
                                                                  FontWeight="DemiBold"
                                                                  HorizontalAlignment="Left"
                                                                  Foreground="Red"
                                                                  Text="El Proveedor tiene Boletas con Humedad Pendiente" Grid.Column="0"
                                                                  Visibility="{Binding BoletaSeleccionada.ClientHasOutStandingHumidity, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:HeaderTextBlock Grid.Row="2"
                                                                  FontSize="14"
                                                                  FontWeight="DemiBold"
                                                                  HorizontalAlignment="Left"
                                                                  Foreground="Red"
                                                                  Text="El Proveedor tiene Ajustes de Boleta Pendiente" Grid.Column="0"
                                                                  Visibility="{Binding BoletaSeleccionada.ClientHasPendingAdjustments, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <misControles:HeaderTextBlock Grid.Row="3"
                                                                  FontSize="14"
                                                                  FontWeight="DemiBold"
                                                                  HorizontalAlignment="Left"
                                                                  Foreground="Red"
                                                                  Text="El Proveedor tiene Ordenes de Diesel Pendiente" Grid.Column="0"
                                                                  Visibility="{Binding BoletaSeleccionada.HasFuelOrderPending, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                </Grid>
                            </Grid>
                        </Grid>
                    </TabItem>
                    <TabItem controlsMahApps:ControlsHelper.HeaderFontSize="16" Header="Pagos">
                        <Grid>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <DataGrid
									AutoGenerateColumns="False"
									IsReadOnly="True"
									ItemsSource="{Binding ListaBoletaCierres}">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Binding="{Binding CodigoLineaCredito}" Header="Linea Crédito" />
                                        <DataGridTextColumn Binding="{Binding FormaDePago}" Header="Tipo Transaccion" />
                                        <DataGridTextColumn Binding="{Binding Monto, StringFormat=N2}" Header="Monto" />
                                        <DataGridTextColumn Binding="{Binding NombreBanco}" Header="Banco" />
                                        <DataGridTextColumn Binding="{Binding NoDocumento}" Header="Ref" />
                                        <DataGridTextColumn Binding="{Binding FechaPago, StringFormat=D}" Header="Fecha Pago" />
                                        <DataGridTextColumn Binding="{Binding FechaTransaccion, StringFormat=D}" Header="Fecha Cierre" />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Grid>
                    </TabItem>
                </TabControl>
            </Grid>
        </Grid>
        <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarAgregar}"
				Imagen="{DynamicResource AgregarPathImagen}"
				Titulo="Crear" />
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarEditar}"
				Imagen="{DynamicResource EditarPathImagen}"
				Titulo="Editar" />
            <misControles:AppBarButton
				Command="{Binding ComandoEliminar}"
				Imagen="{DynamicResource EliminarPathImagen}"
				Titulo="Eliminar" />
            <misControles:Separador />
            <misControles:AppBarButton
				Command="{Binding CommandOpenBoleta}"
				Imagen="{DynamicResource AbrirPathImagen}"
				Titulo="Abrir Boleta" 
                Visibility="{Binding BoletaSeleccionada.ApplieToOpen, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:Separador 
                Visibility="{Binding BoletaSeleccionada.ApplieToOpen, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:AppBarButton
				Command="{Binding ComandoCierreAutorizadoBoleta}"
				Imagen="{DynamicResource CierreForzadoPathImagen}"
				Titulo="Cierre Forzado" 
                Visibility="{Binding BoletaSeleccionada.ApplieToForceClosing, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:Separador Visibility="{Binding BoletaSeleccionada.ApplieToForceClosing, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarAgregarOrdenCombustible}"
				Imagen="{DynamicResource OrdenCombustiblePathImagen}"
				Titulo="Diesel" 
                Visibility="{Binding BoletaSeleccionada.HasFuelOrderPending, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarOtrasDeducciones}"
				Imagen="{DynamicResource OtrasDeduccionesBoletaPathImagen}"
				Titulo="Deducciones" />
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarAgregarDescarga}"
				Imagen="{DynamicResource DescargadoresPathImagen}"
				Titulo="Descarga" />
            <misControles:Separador />
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarPagosBoleta}"
				Imagen="{DynamicResource RegistrarPagoPathImagen}"
				Titulo="Pagos" />
            <misControles:AppBarButton
				Command="{Binding ComandoMostrarAbonosPrestamo}"
				Imagen="{DynamicResource AbonoPrestamoPathImagen}"
				Titulo="Prestamos"
                Visibility="{Binding BoletaSeleccionada.ClientHasLoan, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:Separador />
            <misControles:AppBarButton
				Command="{Binding CommandShowBoletasHumidity}"
				Imagen="{DynamicResource HumidityPaymentPathImagen}"
				Titulo="Humedades" 
                Visibility="{Binding BoletaSeleccionada.ClientHasOutStandingHumidity, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:Separador Visibility="{Binding BoletaSeleccionada.ClientHasOutStandingHumidity, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:AppBarButton
				Command="{Binding CommandShowBoletaAdjustments}"
				Imagen="{DynamicResource AjustePagosPathImagen}"
				Titulo="Ajuste Boletas" 
                Visibility="{Binding BoletaSeleccionada.ClientHasPendingAdjustments, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:Separador 
                Visibility="{Binding BoletaSeleccionada.ClientHasPendingAdjustments, Converter={StaticResource BoolToVisibilityConverter}}"/>
            <misControles:AppBarButton
				Command="{Binding CommandBoletaProperties}"
				Imagen="{DynamicResource PropertyPathImagen}"
				Titulo="Propiedades">
                <i:Interaction.Behaviors>
                    <comportamientos:Seguridad LlaveSeguridad="Boletas Properties" TipoSeguridadPropiedad="Visible"/>
                </i:Interaction.Behaviors>
            </misControles:AppBarButton>
            <misControles:Separador>
                <i:Interaction.Behaviors>
                    <comportamientos:Seguridad LlaveSeguridad="Boletas Properties" TipoSeguridadPropiedad="Visible"/>
                </i:Interaction.Behaviors>
            </misControles:Separador>
            <misControles:AppBarButton
				Command="{Binding ComandoRefrescar}"
				Imagen="{DynamicResource RefrescarPathImagen}"
				Titulo="Actualizar" />
        </misControles:AppBarPanel>

        <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEsperaPrincipal}" d:IsHidden="True">
            <Grid>
                <misControles:BloqueoPanel/>
                <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
            </Grid>
        </Border>
    </Grid>
</wpfCoreWindow:MetroWindowExt>