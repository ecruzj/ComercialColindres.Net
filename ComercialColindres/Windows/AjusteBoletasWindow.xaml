<wpfCoreWindow:MetroWindowExt
    x:Class="ComercialColindres.Windows.AjusteBoletasWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:Comportamientos="clr-namespace:WPFCore.Comportamientos;assembly=WPFCore"
    xmlns:Convertidores="clr-namespace:WPFCore.Convertidores;assembly=WPFCore"
    xmlns:convertidoresLocal="clr-namespace:ComercialColindres.Convertidores"
    xmlns:controlsMahApps="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
    xmlns:misControles="clr-namespace:MisControlesWPF;assembly=MisControlesWPF"
    xmlns:wpfCoreWindow="clr-namespace:WPFCore.UtilidadesWindows;assembly=WPFCore"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
    Title="Ajuste de Boletas"
    Width="1024"
    Height="600"
    MostrarDialogo="{Binding DialogSettings, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
    SaveWindowPosition="True"
    ShowFlyout="{Binding SlidePanelIndice, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
    WindowStartupLocation="CenterScreen">

    <wpfCoreWindow:MetroWindowExt.Resources>
        <Convertidores:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <Convertidores:BoolToStringConverter x:Key="BoolToStringConverter" />
        <Convertidores:StateValueToColorConverter x:Key="StateValueToColorConverter" />
        <Convertidores:DateTimeToShortString x:Key="DateTimeToShortString" />
        <convertidoresLocal:EstadoColorConvert x:Key="EstadoColorConvert" />
    </wpfCoreWindow:MetroWindowExt.Resources>

    <wpfCoreWindow:MetroWindowExt.DataContext>
        <Binding Path="AjusteBoletasViewModel" Source="{StaticResource Locator}"/>
    </wpfCoreWindow:MetroWindowExt.DataContext>

    <wpfCoreWindow:MetroWindowExt.Flyouts>
        <controlsMahApps:FlyoutsControl>
            <controlsMahApps:Flyout x:Name="BusquedaBoletasFlyout"
                Width="700"
                Margin="100,0,0,0"
                Header="Buscar Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <misControles:BusquedaControl
                                Background="{DynamicResource AccentColorBrush}"
                                ComandoBuscar="{Binding CommandSearchBoleta}"
                                ComandoSeleccionarItem="{Binding CommandSelectBoleta}"
                                ListadoColumnas="{Binding BusquedaBoletasControl.ListadoColumnasBusqueda}"
                                ListadoDatos="{Binding BusquedaBoletasControl.DatosEncontrados, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                ValorBusqueda="{Binding BusquedaBoletasControl.ValorBusqueda, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                        </Grid>
                    </ScrollViewer>
                    <Border Grid.RowSpan="1" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="CreateBoletaAjustesFlyout"
                Width="400"                
                Margin="100,0,0,0"
                Header="Crear Ajuste Boleta"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                        <StackPanel Orientation="Vertical">
                            <misControles:HeaderTextBlock Text="Código Boleta" />
                            <misControles:SearchTextBox
                                    BuscarOpcional="{Binding CommandShowSearchBoleta}"
                                    IsReadOnly="True"
                                    Text="{Binding DatoBoleta.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            <misControles:HeaderTextBlock Text="BoletaId" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.BoletaId}" />
                            <misControles:HeaderTextBlock Text="Número de Envío" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.NumeroEnvio}" />
                            <misControles:HeaderTextBlock Text="Proveedor" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.NombreProveedor}" />
                            <misControles:HeaderTextBlock Text="Producto" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.DescripcionTipoProducto}" />
                            <misControles:HeaderTextBlock Text="Planta" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.NombrePlanta}" />
                            <misControles:HeaderTextBlock Text="Motorista" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.Motorista}" />
                            <misControles:HeaderTextBlock Text="Placa" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.PlacaEquipo}" />
                            <misControles:HeaderTextBlock Text="Fecha Ingreso" />
                            <misControles:BodyTextBlock Text="{Binding DatoBoleta.FechaSalida, StringFormat=d}" />
                        </StackPanel>
                    </ScrollViewer>
                    <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding CommandCreateAjuste}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
            <controlsMahApps:Flyout x:Name="AjusteBoletaDetallesFlyout"
                Width="550"
                Margin="100,0,0,0"
                Header="Ajuste Boleta Detalle"
                IsModal="True"
                Position="Right"
                Theme="Adapt">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="70" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <GroupBox Header="AJUSTE DE BOLETA">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Código de Boleta" HorizontalAlignment="Center"/>
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="0" 
                                                                Text="{Binding AjusteBoletaSelected.CodigoBoleta, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Número Envío" HorizontalAlignment="Center" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="1" 
                                                                Text="{Binding AjusteBoletaSelected.NumeroEnvio, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        Text="Proveedor" HorizontalAlignment="Center"/>
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="2" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding AjusteBoletaSelected.Proveedor,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                    <misControles:HeaderTextBlock
                                        Grid.Row="0"
                                        Grid.Column="3"
                                        Text="Planta" HorizontalAlignment="Center" />
                                    <misControles:BodyTextBlock Grid.Row="1" Grid.Column="3" 
                                                                FontSize="12"
                                                                FontWeight="Bold"
                                                                Text="{Binding AjusteBoletaSelected.Planta,
                                                                Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="1">
                        <GroupBox Header="AJUSTE DE BOLETA DETALLE">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="120" />
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" MinHeight="30" />
                                        <RowDefinition Height="Auto" MinHeight="60" />
                                    </Grid.RowDefinitions>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Tipo de Ajuste" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center" Height="16" Margin="5,7"/>

                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="1"
                                        Grid.Column="0"                                        
                                        ItemsSource="{Binding AjusteTipos}"
                                        DisplayMemberPath="Descripcion"
                                        SelectedItem="{Binding AjusteTipoSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding AjusteBoletaDetalleDato.AjusteTipoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="AjusteTipoId">
                                    </ComboBox>
                                    <misControles:HeaderTextBlock Grid.Column="0" Text="Forma de Pago" 
                                                              Grid.Row="2"
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"
                                                              Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>
                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="3"
                                        Grid.Column="0"                                        
                                        ItemsSource="{Binding ListaFormaPagos}"
                                        DisplayMemberPath="Descripcion"
                                        SelectedItem="{Binding FormaDePagoSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding AjusteBoletaDetalleDato.FormaDePago, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="Descripcion"
                                    Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>
                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Banco" 
                                                              Grid.Row="2"
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"
                                                              Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>
                                    <ComboBox
                                        Margin="5"
                                        Grid.Row="3"
                                        Grid.Column="1"
                                        ItemsSource="{Binding ListadoBancos}"
                                        DisplayMemberPath="Descripcion"                                        
                                        SelectedItem="{Binding BancoSeleccionado, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedValue="{Binding AjusteBoletaDetalleDato.BancoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        SelectedValuePath="BancoId"
                                        IsEnabled="{Binding FormaDePagoSeleccionada.RequiereBanco,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>
                                    <misControles:HeaderTextBlock Grid.Column="2" Text="Linea Crédito" 
                                                              Grid.Row="2"
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"
                                                              Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>

                                    <ComboBox Margin="5"
                                              Grid.Row="3"
                                              Grid.Column="2"
                                              HorizontalContentAlignment="Center" 
                                              ItemsSource="{Binding LineasCredito}"
                                              SelectedItem="{Binding LineaCreditoSeleccionada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValue="{Binding AjusteBoletaDetalleDato.LineaCreditoId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              SelectedValuePath="LineaCreditoId"
                                          Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Margin="5" Grid.Column="0" Text="{Binding CodigoLineaCredito}"/>
                                                    <TextBlock Margin="5" Grid.Column="1" Text="{Binding CuentaFinanciera}"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>

                                    <misControles:HeaderTextBlock Grid.Column="1" Text="Monto" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"/>
                                    <misControles:InputTextBox Margin="5" Grid.Row="1" Grid.Column="1"
                                                               Text="{Binding AjusteBoletaDetalleDato.Monto, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                               MaxLength="18"
                                                           Comportamientos:TextBoxMaskBehavior.Mask="Decimal" />

                                    <misControles:HeaderTextBlock Grid.Column="2" Text="Ref" 
                                                              FontWeight="SemiBold"
                                                              TextAlignment="Center"
                                                              Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>
                                    <misControles:InputTextBox Margin="5" Grid.Row="1" Grid.Column="2"
                                                               Text="{Binding AjusteBoletaDetalleDato.NoDocumento, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                               MaxLength="50"
                                                           Visibility="{Binding AjusteTipoSelected.UseCreditLine, Converter={StaticResource BoolToVisibilityConverter}, Mode=TwoWay}"/>

                                    <misControles:HeaderTextBlock Grid.Column="0" Grid.Row="4" Grid.ColumnSpan="2" Text="Observaciones" TextAlignment="Center"
                                                              FontWeight="SemiBold"/>
                                    <misControles:InputTextBox Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="3" 
                                                               Text="{Binding AjusteBoletaDetalleDato.Observaciones, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                               MaxLength="50"/>
                                    <misControles:OnlyImageAutoSizeButton
                                        Grid.Row="4"
                                        Grid.Column="2"
                                        Width="21"
                                        Margin="5,5,0,5"
                                        HorizontalAlignment="Center"
                                        Background="{DynamicResource AccentColorBrush}"
                                        Command="{Binding CommandAddAjusteDetalle}"
                                        Imagen="{DynamicResource AgregarPathImagen}" />

                                </Grid>
                                <Grid Grid.Row="1">
                                    <DataGrid                                    
                                Margin="5"
                                AutoGenerateColumns="False"
                                CanUserAddRows="False"
                                CanUserDeleteRows="False"
                                IsReadOnly="True"                                        
                                ItemsSource="{Binding AjusteBoletaDetallesModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding AjusteBoletaDetalleSelectedModel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Width="55">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding AjusteBoletasViewModel.CommandDeleteAjusteDetalle, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource QuitarPathImagen}" />
                                                            <misControles:OnlyImageAutoSizeButton
                                                        Width="21"
                                                        Height="21"
                                                        Margin="2"
                                                        Background="{DynamicResource AccentColorBrush}"
                                                        Command="{Binding AjusteBoletasViewModel.CommandEditarAjusteDetalle, Source={StaticResource Locator}}"
                                                        Imagen="{DynamicResource EditarPathImagen}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding AjusteTipoDescripcion}" Header="Tipo Ajuste" />
                                            <DataGridTextColumn Binding="{Binding Monto, StringFormat=N2}" Header="Monto" />
                                            <DataGridTextColumn Binding="{Binding Observaciones}" Header="Observaciones" />
                                            <DataGridTextColumn Binding="{Binding FechaCreacion, StringFormat=d}" Header="Fecha Creación" />
                                            <DataGridTextColumn Binding="{Binding CodigoLineaCredito}" Header="Linea Credito"/>
                                            <DataGridTextColumn Binding="{Binding NoDocumento}" Header="Ref" />
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <misControles:AppBarPanel Grid.Row="2" Background="{DynamicResource AccentColorBrush}">
                        <misControles:AppBarButton
                            Command="{Binding CommandSaveAjusteDetalles}"
                            Imagen="{DynamicResource GuardarPathImagen}"
                            Titulo="Guardar" />
                    </misControles:AppBarPanel>
                    <Border Grid.RowSpan="3" Visibility="{Binding MostrarVentanaEspera}">
                        <Grid>
                            <misControles:BloqueoPanel/>
                            <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
                        </Grid>
                    </Border>
                </Grid>
            </controlsMahApps:Flyout>
        </controlsMahApps:FlyoutsControl>
    </wpfCoreWindow:MetroWindowExt.Flyouts>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="70" />
        </Grid.RowDefinitions>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="275" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <GroupBox Header="Busqueda Ajustes de Boletas">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="400*" />
                        <RowDefinition Height="33*" />
                    </Grid.RowDefinitions>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <misControles:TitleTextBlock Text="Buscar" />
                        <misControles:SearchTextBox
							Grid.Row="1"
							Buscar="{Binding CommandSearchAjusteBoleta}"
							SpellCheck.IsEnabled="True"
							Text="{Binding SearchValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                    </Grid>
                    <ListBox
                        Grid.Row="1"
                        Margin="5"
                        IsSynchronizedWithCurrentItem="True"
                        ItemsSource="{Binding AjusteBoletasControl.Items}"
                        SelectedItem="{Binding AjusteBoletaSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Viewbox Margin="2">
                                        <Grid Width="25">
                                            <Path
                                                Fill="{Binding Estado, Converter={StaticResource StateValueToColorConverter}}"
                                                Data="M4.0500023,22.614998L4.0500023,25.118 7.3729998,25.118 7.3729998,22.614998z M22.759,17.995998L22.759,19.301998C21.289998,19.59 20.436994,20.538998 20.436994,21.747997 20.436994,23.080997 21.440992,23.768997 22.910993,24.263 23.927991,24.606998 24.367994,24.937 24.367994,25.458 24.367994,26.007999 23.831998,26.310997 23.048993,26.310997 22.154996,26.310997 21.344999,26.022999 20.767995,25.706997L20.354993,27.313999C20.876996,27.615997,21.770993,27.863998,22.691999,27.904999L22.691999,29.209999 24.037992,29.209999 24.037992,27.808998C25.619001,27.534 26.483991,26.488998 26.483991,25.266998 26.483991,24.029999 25.824002,23.273998 24.188993,22.696999 23.020002,22.257 22.539991,21.968998 22.539991,21.514999 22.539991,21.128998 22.828992,20.744999 23.72099,20.744999 24.710996,20.744999 25.341993,21.060997 25.701001,21.210999L26.097989,19.659C25.645993,19.439999,25.02699,19.246998,24.106992,19.205997L24.106992,17.995998z M23.419004,16.041C27.594999,16.041 30.980998,19.426998 30.980998,23.603001 30.980998,27.778999 27.594999,31.164997 23.419004,31.164997 19.241994,31.164997 15.857001,27.778999 15.857001,23.603001 15.857001,19.426998 19.241994,16.041 23.419004,16.041z M4.0500023,15.784L4.0500023,18.286999 7.3729998,18.286999 7.3729998,15.784z M4.0500023,9.185997L4.0500023,11.688999 7.3729998,11.688999 7.3729998,9.185997z M9.2819969,9.1559982L9.2819969,11.657997 19.368993,11.657997 19.368993,9.1559982z M17.849996,0.096000671L23.419004,7.8219986 16.392995,3.4899979z M0,0L16.367994,0 14.411001,4.4580002 23.341993,9.4899979 23.341993,14.792999C21.910993,14.806,20.562993,15.162998,19.37,15.782997L19.37,15.753998 9.2819969,15.753998 9.2819969,18.257 16.428998,18.257C15.484999,19.487,14.856001,20.968998,14.668997,22.585999L9.2819969,22.585999 9.2819969,25.089001 14.740996,25.089001C15.298994,28.354,17.650998,31.011997,20.748998,32L0,32z"
                                                RenderTransformOrigin="0.5,0.5"
                                                Stretch="Uniform" />
                                        </Grid>
                                    </Viewbox>
                                    <StackPanel
                                        Width="185"
                                        Margin="5"
                                        Orientation="Vertical">
                                        <TextBlock
                                            Margin="1"
                                            HorizontalAlignment="Stretch"
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Text="{Binding CodigoBoleta}"
                                            TextWrapping="Wrap" />
                                        <TextBlock
                                            Margin="1"
                                            HorizontalAlignment="Stretch"
                                            FontSize="10"
                                            Text="{Binding Proveedor}"
                                            TextWrapping="Wrap" />
                                        <TextBlock
                                            Margin="1"
                                            HorizontalAlignment="Stretch"
                                            Foreground="{Binding Estado, Converter={StaticResource StateValueToColorConverter}}"
                                            FontSize="12"
                                            FontWeight="Bold"
                                            Text="{Binding Estado}"
                                            TextWrapping="Wrap" />
                                        <Rectangle Height="6" Style="{StaticResource EstiloRectanguloEnListas}" />
                                    </StackPanel>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <misControles:PaginarControl
						Grid.Row="2"
						Width="170"
						Background="{DynamicResource AccentColorBrush}"
						ComandoAnterior="{Binding CommandSurf}"
						ComandoSiguiente="{Binding CommandSurf}"
						NumeroPagina="{Binding NumeroPagina, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
						TotalPaginas="{Binding AjusteBoletasControl.TotalPagina}" />
                </Grid>
            </GroupBox>
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="300" />
                    <RowDefinition Height="*" MinHeight="220"/>
                </Grid.RowDefinitions>
                <GroupBox Grid.Row="0" Header="Ajuste Detalles">
                    <TabControl>
                        <TabItem controlsMahApps:ControlsHelper.HeaderFontSize="16" BorderBrush="Red">
                            <Grid>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <DataGrid
									AutoGenerateColumns="False"
									IsReadOnly="True"
									ItemsSource="{Binding AjusteBoletaDetalles, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        SelectedItem="{Binding AjusteBoletaDetalleSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding AjusteBoletaDetalleId}" Header="Id" />
                                            <DataGridTextColumn Binding="{Binding AjusteTipoDescripcion}" Header="Tipo de Ajuste" />
                                            <DataGridTemplateColumn Header="Monto">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Monto, StringFormat=N2}" HorizontalAlignment="Right"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTextColumn Binding="{Binding CodigoLineaCredito}" Header="LineaCredito" />
                                            <DataGridTextColumn Binding="{Binding NoDocumento}" Header="#Documento" />
                                            <DataGridTextColumn Binding="{Binding Observaciones}" Header="Observaciones" />
                                            <DataGridTextColumn Binding="{Binding Estado}" Header="Estado" />
                                            <DataGridTextColumn Binding="{Binding ModificadoPor}" Header="Creado Por" />
                                            <DataGridTemplateColumn Header="Fecha Creacion">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding FechaCreacion, StringFormat=d}" HorizontalAlignment="Right"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                    <Grid Grid.Row="1" HorizontalAlignment="Right">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="Auto" MinWidth="40" />
                                        </Grid.ColumnDefinitions>
                                        <misControles:HeaderTextBlock Grid.Row="0"
                                                                 FontSize="14"
                                                                 Text="Total"
                                                                  FontWeight="SemiBold"/>
                                        <misControles:BodyTextBlock Grid.Row="0"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding AjusteBoletaSelected.Total,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right"/>
                                        <misControles:HeaderTextBlock Grid.Row="1"
                                                                 FontSize="14"
                                                                 Text="Abonos"
                                                                  FontWeight="SemiBold"/>
                                        <misControles:BodyTextBlock Grid.Row="1"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding AjusteBoletaSelected.Abonos,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right"
                                                                Foreground="Green"/>
                                        <misControles:HeaderTextBlock Grid.Row="2"
                                                                 FontSize="14"
                                                                 Text="Saldo"
                                                                  FontWeight="SemiBold"/>
                                        <misControles:BodyTextBlock Grid.Row="2"
                                                               Grid.Column="1"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               Text="{Binding AjusteBoletaSelected.Saldo,
                                                                              Mode=TwoWay,
                                                                              UpdateSourceTrigger=PropertyChanged,
                                                                              StringFormat=N2}"
                                                               TextAlignment="Right" />
                                    </Grid>
                                </Grid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </GroupBox>

                <GroupBox Grid.Row="1" Header="Ajuste Pagos">
                    <TabControl Grid.Row="1">
                        <TabItem controlsMahApps:ControlsHelper.HeaderFontSize="16" BorderBrush="Red">
                            <Grid>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <DataGrid
									AutoGenerateColumns="False"
									IsReadOnly="True"
									ItemsSource="{Binding AjusteBoletaPagos, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Binding="{Binding CodigoBoleta}" Header="#Boleta" />
                                            <DataGridTextColumn Binding="{Binding NumeroEnvio}" Header="#Envio" />
                                            <DataGridTextColumn Binding="{Binding Planta}" Header="Planta" />
                                            <DataGridTemplateColumn Header="Monto">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding Monto, StringFormat=N2}" HorizontalAlignment="Right"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="Fecha Pago">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBlock Text="{Binding FechaAbono, StringFormat=D}" HorizontalAlignment="Right"/>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </GroupBox>
            </Grid>
        </Grid>
        <misControles:AppBarPanel Grid.Row="1" Background="{DynamicResource AccentColorBrush}">
            <misControles:AppBarButton
				Command="{Binding CommandShowCreateAjuste}"
				Imagen="{DynamicResource AgregarPathImagen}"
				Titulo="Crear" />
            <misControles:AppBarButton
				Command="{Binding CommandDeleteHumidity}"
				Imagen="{DynamicResource EliminarPathImagen}"
				Titulo="Eliminar" />
            <misControles:Separador />
            <misControles:AppBarButton
				Command="{Binding CommandShowAjusteDetalles}"
				Imagen="{DynamicResource AjusteDetallePathImagen}"
				Titulo="Detalles" />
            <misControles:Separador />
            <misControles:AppBarButton
				Command="{Binding CommandActivateAjusteBoleta}"
				Imagen="{DynamicResource ActivarPrestamoPathImagen}"
				Titulo="Activar" />
            <misControles:Separador />
            <misControles:AppBarButton
				Command="{Binding CommandRefresh}"
				Imagen="{DynamicResource RefrescarPathImagen}"
				Titulo="Actualizar" />
        </misControles:AppBarPanel>

        <Border Grid.RowSpan="2" Visibility="{Binding MostrarVentanaEsperaPrincipal}" d:IsHidden="True">
            <Grid>
                <misControles:BloqueoPanel/>
                <controlsMahApps:ProgressRing IsActive="True" IsLarge="False"/>
            </Grid>
        </Border>
    </Grid>
</wpfCoreWindow:MetroWindowExt>